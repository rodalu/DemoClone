name: GraphAPI

on:
   workflow_dispatch:
   push: 
      branches: [ main ]
 

jobs:
  build:
    runs-on: ubuntu-latest

    steps:     
         - uses: actions/checkout@v2
     
         - name: Test Query Users
           run: |   
            curl --header "Content-Type: application/json" \
            --request POST \
            --data '{"query":"query { users ( where:{ _and: [ { diagnosis_code: {_in: [\"S00-T88\",\"T20-R73\"]}}, 
            { price: {_lt: 150}}, { users: {_gt: 10}} ] } ) { email, id } }","variables":null}' \
            https://jsonplaceholder.typicode.com/users
        
         - name: Test Query JSON File from REPO
           run: |   
              curl -i -H 'Content-Type: application/json' \
              -H "Authorization: ${{secrets.GITHUB_TOKEN}} " \
              -X POST -d "{ \"query\": \"$script\"}" https://api.github.com/graphql

              
  graphqltestquery:
    runs-on: ubuntu-latest
    steps:  
         - uses: actions/checkout@v2  
         - name: Test Sample
           run: |           
            curl -X POST -H "Authorization: 'bearer ' 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" \
            -H "Content-Type: application/json" \
            -d '{"query": "query { repository(owner:\"octocat\", name:\"hello-world\") { name description primaryLanguage { name } } }"} '\
             https://api.github.com/graphql